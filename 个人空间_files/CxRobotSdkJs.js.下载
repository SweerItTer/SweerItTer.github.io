var CxRobotSdkJs=function(){"use strict";function t(t,e,n,o,r,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(o,r)}function e(e){return function(){var n=this,o=arguments;return new Promise((function(r,i){var a=e.apply(n,o);function s(e){t(a,r,i,s,c,"next",e)}function c(e){t(a,r,i,s,c,"throw",e)}s(void 0)}))}}function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=i.call(n)).done)&&(s.push(o.value),s.length!==e);c=!0);}catch(t){u=!0,r=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var a={exports:{}},s={exports:{}};!function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(s);var c=s.exports;!function(t){var e=c.default;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
t.exports=n=function(){return r},t.exports.__esModule=!0,t.exports.default=t.exports;var o,r={},i=Object.prototype,a=i.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",d=c.toStringTag||"@@toStringTag";function p(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(o){p=function(t,e,n){return t[e]=n}}function f(t,e,n,o){var r=e&&e.prototype instanceof w?e:w,i=Object.create(r.prototype),a=new P(o||[]);return s(i,"_invoke",{value:E(t,n,a)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var v="suspendedStart",g="suspendedYield",y="executing",m="completed",b={};function w(){}function x(){}function k(){}var _={};p(_,u,(function(){return this}));var S=Object.getPrototypeOf,T=S&&S(S(N([])));T&&T!==i&&a.call(T,u)&&(_=T);var I=k.prototype=w.prototype=Object.create(_);function O(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,n){function o(r,i,s,c){var u=h(t[r],t,i);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==e(d)&&a.call(d,"__await")?n.resolve(d.__await).then((function(t){o("next",t,s,c)}),(function(t){o("throw",t,s,c)})):n.resolve(d).then((function(t){l.value=t,s(l)}),(function(t){return o("throw",t,s,c)}))}c(u.arg)}var r;s(this,"_invoke",{value:function(t,e){function i(){return new n((function(n,r){o(t,e,n,r)}))}return r=r?r.then(i,i):i()}})}function E(t,e,n){var r=v;return function(i,a){if(r===y)throw new Error("Generator is already running");if(r===m){if("throw"===i)throw a;return{value:o,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=A(s,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===v)throw r=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=y;var u=h(t,e,n);if("normal"===u.type){if(r=n.done?m:g,u.arg===b)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=m,n.method="throw",n.arg=u.arg)}}}function A(t,e){var n=e.method,r=t.iterator[n];if(r===o)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=o,A(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(r,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,b;var a=i.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=o),e.delegate=null,b):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function N(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function e(){for(;++r<t.length;)if(a.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=o,e.done=!0,e};return i.next=i}}throw new TypeError(e(t)+" is not iterable")}return x.prototype=k,s(I,"constructor",{value:k,configurable:!0}),s(k,"constructor",{value:x,configurable:!0}),x.displayName=p(k,d,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,p(t,d,"GeneratorFunction")),t.prototype=Object.create(I),t},r.awrap=function(t){return{__await:t}},O(j.prototype),p(j.prototype,l,(function(){return this})),r.AsyncIterator=j,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new j(f(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(I),p(I,d,"Generator"),p(I,u,(function(){return this})),p(I,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var o in e)n.push(o);return n.reverse(),function t(){for(;n.length;){var o=n.pop();if(o in e)return t.value=o,t.done=!1,t}return t.done=!0,t}},r.values=N,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&a.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=o)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return s.type="throw",s.arg=t,e.next=n,r&&(e.method="next",e.arg=o),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&a.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=t,i.arg=e,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),L(n),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var r=o.arg;L(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:N(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=o),b}},r}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(a);var u=(0,a.exports)(),l=u;try{regeneratorRuntime=u}catch(t){"object"===("undefined"==typeof globalThis?"undefined":n(globalThis))?globalThis.regeneratorRuntime=u:Function("r","regeneratorRuntime = r")(u)}var d=i(l),p='[data-scene=course].expand{width:700px!important;height:90vh!important;background-color:#fff;border-radius:15px;overflow:hidden;background:url(https://robot-static.chaoxing.com/robot-res/robot-sdk/images/bg.png) no-repeat;background-size:cover;box-shadow:0 0 4px #ccc}[data-scene=course].loading .loading-wrapper{width:100%;height:100%;display:block}[data-scene=course].loading .figure-wrapper{display:none}[data-scene=course].loading .course{display:block;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}[data-scene=course].loading .course .slogan{position:absolute;top:-65px;left:20px;width:200px;height:51px;line-height:48px;text-align:center;animation:sloganIn 2s forwards;opacity:0;background-image:url(https://robot-static.chaoxing.com/robot-res/robot-sdk/images/arrow.png);background-size:contain}[data-scene=course].loading .course .slogan .text{font-family:Microsoft YaHei;position:relative;z-index:1;color:#333;font-size:16px;white-space:nowrap;font-weight:700}[data-scene=course].loading .course .progress{position:relative;width:240px;height:12px;background:#fff;border-radius:50px}[data-scene=course].loading .course .progress .inner{width:80%;height:100%;border-radius:inherit;background:linear-gradient(90deg,#66b3ff,#5959ff)}[data-scene=course].loading .course .progress .percent{position:absolute;right:-10px;top:50%;transform:translate(100%,-50%)}[data-scene=course].loading.anchor-figure .figure-wrapper{display:block}[data-scene=course].loading.anchor-figure .loading-wrapper{display:none!important}[data-scene=course] .interaction-wrapper{width:100%!important;height:100%!important}[data-scene=course] .interaction-header{height:20px!important}[data-scene=course] .interaction-header .minimize{display:none}[data-scene=course] .course-notify{position:absolute;font-size:14px;transform:translate(-80%,-100%);border-image:url(https://robot-static.chaoxing.com/robot-res/robot-sdk/images/hi.popup.png) 106 30 50 84 fill/20px 10px 20px 30px;z-index:1;box-sizing:border-box;border-radius:20px 20px 0;width:var(--cxrbt-notify-width, 300px);filter:drop-shadow(6px 6px 4px rgba(182,182,182,.2));padding:20px;min-height:var(--cxrbt-notify-min-height, 90px)}[data-scene=course] .course-notify .inner{font-family:Microsoft YaHei;font-size:14px;font-weight:600;line-height:24px;word-spacing:10px;color:var(--cxrbt-notify-color, #71360b);z-index:1;box-sizing:border-box}[data-scene=course] .course-notify .inner::-webkit-scrollbar{display:none}[data-scene=course] .course-notify .text-wrap{max-height:var(--cxrbt-notify-max-height, 60vh);overflow:auto}[data-scene=course] .course-notify .text-wrap::-webkit-scrollbar{display:none}[data-scene=course] .course-notify .text-wrap .text{vertical-align:middle;display:table-cell}[data-scene=course] .course-notify .text-wrap .icon{width:20px;height:20px;position:relative;top:4px}[data-scene=course] .course-notify.trial{min-height:unset;transform:translate(-100%,-45%)}[data-scene=course] .course-notify.trial .inner{word-spacing:normal}@keyframes sloganIn{0%{opacity:0}to{opacity:1}}[data-scene=course].small .figure-wrapper{display:none!important}[data-scene=course].small .small-figure{display:block}[data-scene=course] .small-figure{display:none;max-width:100px;max-height:100px}[data-scene=normal].loading .loading-wrapper{width:100%;height:100%;display:block;position:absolute;top:0;left:0}[data-scene=normal].loading .normal{display:block;position:absolute;max-width:100%;max-height:100%;bottom:0}[data-scene=normal] .interaction-wrapper{filter:drop-shadow(0 4px 3px #ccc)}.bare-sdk{width:100%;height:100%}.cx-robot-side-open{overflow:hidden}.cx-robot-side{position:fixed;left:0;top:0;right:0;bottom:0;z-index:999;transition:opacity .3s ease}.cx-robot-side.hide{opacity:0;pointer-events:none}.cx-robot-side .interaction-container{box-sizing:border-box;background-color:#fff;position:absolute;width:400px;top:0;right:0;bottom:0;transition:transform .3s ease;transform:translate(calc(100% + 10px));border-radius:10px 0 0 10px;box-shadow:3px 0 14px 1px #909399}.cx-robot-side .interaction-container.expand{transform:translate(0)}.cx-robot-side .interaction-container iframe{border-radius:10px}.cx-robot-side .side-close{position:absolute;top:40%;left:-4px;transform:translate(-50%,-50%);width:16px;height:50px;background-color:#fff;cursor:pointer;border-radius:4px 0 0 4px;box-shadow:3px 0 14px 1px #909399}.cx-robot-side .side-close:before{content:"";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) rotate(180deg);width:0;height:0;border-top:6px solid transparent;border-bottom:6px solid transparent;border-right:6px solid #1f80ff}.cx-robot-side .side-content{width:100%;height:100%;position:relative;padding:10px;background-color:#fff;box-sizing:border-box;border-radius:inherit}.anchor-figure{width:100%!important;height:100%!important;opacity:1!important;display:block!important}.cx-robot-trigger.mini{display:none}.cx-robot-trigger.loading{position:relative}.cx-robot-wrapper{display:block;position:fixed;z-index:999999;touch-action:none}.cx-robot-wrapper iframe{background-color:#fff;box-shadow:0 0 4px #ccc}.cx-robot-wrapper .loading-wrapper{position:relative;display:none}.cx-robot-wrapper .loading-wrapper>*{display:none}.cx-robot-wrapper .notify{position:absolute;left:0;top:-50px;padding:10px;background-color:#fffc;border-radius:4px;font-size:14px;box-shadow:0 10px 42px 10px #3e424238}.cx-robot-wrapper .resizer{position:absolute;width:20px;height:20px;background-color:#fff;border-radius:50%;right:0;top:0;box-sizing:border-box;transform:translateY(-100%);cursor:pointer;box-shadow:0 0 4px #ddd}.cx-robot-wrapper .resizer svg{padding:4px;width:100%;height:100%;fill:#333;box-sizing:border-box}.cx-robot-wrapper .figure-wrapper{transition:all .5s;width:100%;height:100%;margin:0 auto;display:block}.cx-robot-wrapper .figure-wrapper.mini{display:none}.cx-robot-wrapper .figure-wrapper.toon{width:200px;height:200px}.cx-robot-wrapper .figure-wrapper.toon[data-mobile=true]{width:100px;height:100px}.cx-robot-wrapper .interaction-wrapper{position:relative;display:none;overflow:hidden;border-radius:15px}.cx-robot-wrapper .interaction-header{width:100%;height:60px;line-height:60px;position:absolute;top:0;bottom:0;cursor:move}.cx-robot-wrapper .minimize{width:30px;height:30px;text-align:center;font-size:14px;font-weight:700;cursor:pointer;position:absolute;right:10px;top:50%;transform:translate(-50%,-50%)}.cx-robot-wrapper .minimize .inner{background-color:#fff;width:20px;height:4px;position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}.cx-robot-wrapper .interaction-content{width:100%;height:100%}\n';function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,e||"default");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===n(e)?e:String(e)}function v(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,h(o.key),o)}}function g(t,e,n){return e&&v(t.prototype,e),n&&v(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function y(t,e,n){return(e=h(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m=function(){function t(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).headers;f(this,t),this.getBaseHeader=function(){return"function"==typeof e?e():e||{}}}return g(t,[{key:"get",value:function(t,e,n,o){var r=new XMLHttpRequest;r.open("GET",t,!0),r.withCredentials=!0;var i=Object.assign({},this.getBaseHeader(),e);if(i)for(var a in i)r.setRequestHeader(a,i[a]);r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var t=JSON.parse(r.responseText);"function"==typeof n&&n(t)}else 4===r.readyState&&200!==r.status&&"function"==typeof o&&o(r.status)},r.send()}},{key:"post",value:function(t,e,n,o,r){var i=new XMLHttpRequest;i.open("POST",t,!0),i.withCredentials=!0;var a=Object.assign({},this.getBaseHeader(),n);if(a)for(var s in a)i.setRequestHeader(s,a[s]);i.onreadystatechange=function(){if(4===i.readyState&&200===i.status){var t=JSON.parse(i.responseText);"function"==typeof o&&o(t)}else 4===i.readyState&&200!==i.status&&"function"==typeof r&&r(i.status)},i.send(JSON.stringify(e))}}]),t}(),b=function(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){var r=n[o].trim();if(0===r.indexOf(e))return r.substring(e.length,r.length)}return""},w=function(t){return function(){if(document){var e=document.createElement("style"),n=document.createTextNode(t);return e.appendChild(n),document.head.appendChild(e),function(){e.parentNode&&e.parentNode.removeChild(e)}}}()};function x(t){var e=new Blob(["hello world"],{type:"text/plain"}),n=URL.createObjectURL(e);URL.revokeObjectURL(n);var o=n.split("/").pop();return"function"==typeof t?t(o):o}function k(t){return void 0===t}function _(t){var e=this,n=["robot.chaoxing.com","robot-lc.chaoxing.com","robot1.chaoxing.com","robot-lc1.chaoxing.com","robot-dev.chaoxing.com","robot-lc2.chaoxing.com","robot2.chaoxing.com","localhost"].includes(window.location.hostname);if(this.isChaoxingMooc||n){var o=2e4,r=function(){var n=e.$dom;if(!e.isShowSmallFigure){var o=n.querySelector(".small-figure");if(!o){var r=document.createElement("img");r.src=t.miniToonPreset||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAAA2CAMAAABuiU6iAAACXlBMVEUAAAALCwsKCgoKCgoHBwcEBAQ1Hw/l4dEzIBcyIBXQq0jw7ugyIBf+/fT29+fs7Nnq5tf9/uz/89//2Vr8/ef+8t37+egzIBYyIBb61Vg2Ihny5tI0IBgwIBQwIBj++vH9/ub///X99+0yIBf8+fP7/ef989791lj+11j92F748N/91VcyIBUyIBfCvLnIyLbR0cjRyLf+/Pb+9uj/2Fn9/fUzIBb83XP+1lj81lf81VdHLSVILSX501f50FcwIBbp7eX30VXjxlU4IBj/2FkzIBdHLSX/kyb+/+/+//H+/+v///P///b/9eL+/+j/9uX/+ez+/+7/+Oj/9N7+/+3/+Or/+/L/9+b//PT/893+/+r/9OD/1lb/zk///Pb/+vD/1FX///j/+u7/wUL/+e7/y0z/9+r/2mP/0VP/rTj/szT/sDHmhSQ8JRz/+/H+/+f/8dP/vT7/myw/LST/89n/883/0FH/zU7/pDP/ri+zZyBMLhj/+Nj/7Mr/yEn/w0T/sTz/uDlMOjD/oC/MdiKZWR7/7a7/4IKWiHr/33f/22r/x0zRrUz/vkb/tT//qDZeQiw4Ixr/+uf/+d//77j/44z/3Gz/2mL0zVX/xkb/ukJXRjqMbTj/lylSNyjyjCXZfSO/byFBKSCmYB9zRBtZNRpMLhlAJxj/+vL++uPy5s3m2MDMwrCMfnJ+cGT/2mH/0FlmVkv/vUb/nC1mPRtmPBr/8Nfl1r3+6Z7Lup7/5py/r5uyo5D/1Yyml4X+0n7/3W3/0Gb/zF1wYVfowlKYeDv/nCy/biGASxx/Sxy98AAOAAAARHRSTlMABggKDQsQR79gFGbv4ZVnV/Dw7+Hgw7CfgoBlQEAg8PDv4d/S0dHR0MGUkZBwKionJ/Dw39HPwbChYWFgUlJQRUIkIKlXX+0AAATqSURBVFjD7Zb3UxpBFIDhDsSSGNN77733nixexBCNRBARQZSAxBhIQEmxa4zRmF6ssab33nv9r/J2lzuZ3KGM+lMm3yx7e8vyzbv39o6ThUnE4rFjo6bIBpGIqEg1ITIqYpCUkxcNUQsMGTd5EIwTeKPAzHEDSQMkMpI3nT8InD+vpqzpd3q3RvK+jniBjoNqPr39kk4aN1MNHIz/C6IdsmiSrJ9EjVWr40VAmJMGtAt2ToiPbz13jveR0YQB76uNzXUIoWt1za2t3+uuwbCuedOAhNHbF85DPN+wkTJv4Zbofho3zx+JQrNuQz+U48HYO6vW7wjfJwdAGQ7jZfIwnTJ59FwUhPVMaa7/MKbCf7a+1oqCmBsNEYQRJsNsW4t6OOPnMNfzAI7gP4N6mK9iQNunMmZoFhJwVnBcZVXXDTXlZndXJ6jPOpGAcfTE3q3w7bLVWVlZDsHZwlU+U//FszbuqWA9bTQaRy+HaENnk4mZvhukr1CAp1yVWoIqzs+vuKwD64i40MHKmbjdhNt8Prlj1FJ+hB47Asd2rhZRfEZsNU5kQuwDuPbpuyknEeEsR5N56sXLJnLUFt0nEze4XER4owMntBGQgRBFGpqYmEitNQhzuJIoHht03rd4cNdbdIfG2vaDZtRkAiOIdXMYsEoVKSYRQxNwBQGBq3/gvlD0Gg/cF9wXy8nUMY443VqTLsBEKJZkoAkJCUQL4hOOHuljr9f7Dg/uuXXuIz3Sh26t1gRgp2k0w0hJVeAEK4VY+Tp9KLpHXOV379ynMz85cBZpARNFq1WJpbDrY3cB2CtYD+epQ9BWga76DElJ2Io/0C2QuH6GGQNOogWI9Uop1y3t7OZyr/gMIAUtzxyxVC5nh+8FqJdaq2u5Sl5Tfqqp6RTkgJLHFdSkpBioloqTRoiTKmfYffuoVciBAzZqp2D9+oB33mznStHV1P2gTerBwEpJNRrNPgBridQHT70KLu83r+WVVdfJ1vdiK3gJSQYslSjUcA3WagQrua1K4anXXtX1/Djh+a/OSo5raUTApdT9YIVGzSkrJSOdna7BCLFWI0xBfQUXTIu/0UofJcmpqakp2EzYPwakclGhYtMBoqV5dQiP/ton9aW5QH3jk0IwUmqSwQqNZ4FkpKo9ALZCwUB6EfXO1RybLZkAZuhUkjllRxFresDqQ31gsdhsOTnJAWawOFJxqMMOHQqK9UQfToclPx9rwYu7YSzDyKRCnR1k3XXB0bv08i19vgWw5dgACJSUSRzq0mlEiq1w/SdRMGZPmTn4/JNWr9dbLPnQIOKpS1hGUsonIJ2GCqW6VG23m8324gZP2VGCy5MNM057cbUvOS0tTa+/pafEkYxKwbBs3DRSLLxb8a766DoAuFxlZR5PdrbHU+Zy0Zn3mZlp2EqZGqOkTulQ2aWjSALoLZDwuSQbU9JQbLcXFtqLixtKSsjEl0wgLcCsJUpSpZBWpWLYKFIqIi0wmwsfmc3mAqcV43SSiUKYwFKqHRqjAGfov2iwMoxSoYodM5zeqxkZGdZLNRkAAjIIp09aoc/CZK6YFatSKFiRU7yxWKVSISYCNxFKVglKJoy3KfASM6uAnlXACD5wCh2ZYGGCLMEdLA/ntY96wUzgB6JTWIKRA+G99FLIbxjaSyKHIEEZNrA6HGSDgVz2n3+IP7rClZpET2jcAAAAAElFTkSuQmCC",r.className="small-figure",r.onclick=function(){e._openWin(),e.emit("winVisibleChange",!0)},n.appendChild(r),o=r}e.setTranslate(0,0),n.classList.add("small"),e.isShowSmallFigure=!0}},i=function(){var t=e.$dom;e.isShowSmallFigure&&(t.classList.remove("small"),e.isShowSmallFigure=!1)};this._close=function(){if("openUrl"!==e.opt.type){var t=e.$figure,n=e.$dom.querySelector(".interaction-wrapper");t.style.display=e.showSmallFigure?"none":"block",n.style.display="none",e.$dom.classList.remove("expand"),e.emit("winVisibleChange",!1)}};return this.on("domloaded",(function(){e.$dom.style.right="10px",e.$dom.style.bottom="10px";var t=e.$toonRobot;t&&t.on("wakeup",(function(){i(),e.smallSwitchTimer=setTimeout(r,o)})),e.$dom.addEventListener("mouseenter",(function(){var t=e.$dom.classList.contains("expand");!e.isShowSmallFigure||t?e.smallSwitchTimer&&clearTimeout(e.smallSwitchTimer):i()})),e.$dom.addEventListener("mouseleave",(function(){var t=e.$dom.classList.contains("expand");e.isShowSmallFigure||t||(e.smallSwitchTimer=setTimeout(r,o))})),e.smallSwitchTimer=setTimeout(r,o)})),this.on("dragEnd",(function(t){var e=t.x,n=t.y,o=t.width,i=t.height,a=window,s=a.innerWidth,c=a.innerHeight;(s-e-o<100||c-n-i<100)&&r()})),t}}var S="course-notify",T=null;function I(t){var e=t.$options,n=new XMLHttpRequest,o="".concat(e.origin,"/v1/front/mobileLearnComp/timeTip");n.open("GET",o,!0),n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var e=JSON.parse(n.responseText||"{}").data||{},o=e.curAlertTip,r=e.curIconUrl,i=e.nextAlertTime,a=e.duration,s=void 0===a?6e3:a;if(t.nextAlertTime=i,!o)return;t.notify(o,r),setTimeout((function(){t.stopNotify(),O(t)}),s)}},n.send()}function O(t){var e=t.nextAlertTime;if(e){T&&clearTimeout(T);var n=new Date(e).getTime()-Date.now();T=setTimeout((function(){return I(t)}),n)}}function j(t){var e,n=this;return'\n    <div class="course">\n      '.concat(117994==+t.unitId&&"b01ea65abfb645d2a6aa3315025d0738"===t.robotId&&((e=new Date).setFullYear(2024),e.setMonth(7),e.setDate(8),e.setHours(23),e.setMinutes(59),e.setSeconds(59),Date.now()<=e.getTime())?"":'<div class="slogan">\n              <div class="text">'.concat(n.$i18n.t("course.slogan"),"</div>\n            </div>"),'\n      <div class="progress">\n        <div class="inner"></div>\n        <div class="percent"></div>\n      </div>\n    </div>\n  ')}var E=[{install:function(t){var e=this;if("course"===t.scene){t.element||_.call(this,t);var n=null,o=null,r=null;if(this.notify=function(e,n){this.stopNotify();var o=this.$figure;var r='\n        <div class="'.concat(S,' notify-wrapper">\n          <div class="inner">\n            <div class="text-wrap">\n              <div class="text">').concat(e).concat(n?'<img class="icon" src="'.concat(n,'" alt="').concat(n,'" />'):"","</div>\n            </div>\n          </div>\n        </div>\n      ");1==+t.trial&&(r='\n          <div class="'.concat(S,' trial">\n            <div class="inner">\n              <div class="text-wrap">\n                <div class="text">').concat(e,"</div>\n              </div>\n            </div>\n          </div>\n        "));var i=(new DOMParser).parseFromString(r,"text/html").body.children[0],a=o.childNodes[0];o.insertBefore(i,a)},this.stopNotify=function(){var t=this.$figure,e=t&&t.querySelector(".".concat(S));e&&e.parentNode.removeChild(e)},this.on("progress",(function(t){o.innerText=t+"%",r.style.width=t+"%"})),this.on("domloaded",(function(t,i){var a=t.querySelector(".loading-wrapper"),s=(new DOMParser).parseFromString(j.call(e,e.opt),"text/html");n=s.body.children[0],o=n.querySelector(".percent"),r=n.querySelector(".inner"),a.appendChild(n),document.querySelector(".interaction-header .minimize").innerHTML=""})),this.on("initSuccess",(function(n){var o,r,i;e.opt.useBuiltInNotify&&(1!=+t.trial?I(e):(r=null,i=(o=e).$i18n,o.once("winVisibleChange",(function(){r&&clearTimeout(r)})),o.on("destroy",(function(){r&&clearTimeout(r)})),function t(){o.notify(i.t("course.trial")),r=setTimeout((function(){o.stopNotify(),r=setTimeout((function(){t()}),18e4)}),3e3)}()))})),this.once("winVisibleChange",(function(t){t&&e.stopNotify()})),1!=+t.trial){var i=function(){"visible"===document.visibilityState&&O(e)};document.addEventListener("visibilitychange",i),this.on("destroy",(function(){document.removeEventListener("visibilitychange",i)}))}}}}],A="10008359";function C(t,e){var n=e.origin,o=e.appid,r=e.unitId,i=e.robotId,a=e.uid;return new Promise((function(e,s){var c="".concat(n,"/v1/api/doorChat/signature?appId=").concat(o,"&unitId=").concat(r,"&robotId=").concat(i,"&uid=").concat(a);t.get(c,null,(function(t){var n=t.data,o=t.statusCode,r=t.msg;0===o?e(n):s(new Error("签名失败:".concat(r)))}))}))}function L(t,e){return P.apply(this,arguments)}function P(){return(P=e(d.mark((function t(e,n){var o,r,i,a,s,c,u,l,p;return d.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"https:"!==location.protocol&&"localhost"!==location.hostname&&e.once("initSuccess",(function(){e.notify("建议使用https访问获取更多服务"),setTimeout((function(){return e.stopNotify()}),2e3)})),t.next=3,navigator.permissions.query({name:"microphone"});case 3:return"granted"!==t.sent.state&&(e.notify("建议打开浏览器麦克风获取语音服务"),setTimeout((function(){return e.stopNotify()}),2e3)),o=e.ajax,r=e.opt,i=r.origin,a=r.robotId,s=r.unitId,c=b("UID")||x((function(t){return t.replace(/-/g,"")})),u=new DOMParser,t.next=11,C(o,{origin:i,appid:A,unitId:s,robotId:a,uid:c});case 11:l=t.sent,p=function(t){var n=e.iframe;if(e.winVisible){var r={type:"CXBOT:send",data:{text:t}};n.contentWindow.postMessage(r,"*")}else{var s={question:{content:t},appId:A,uid:c,robotId:a,robotUid:l.robotUid,timestamp:l.timestamp},d={"Content-Type":"application/json",signature:l.signature};o.post("".concat(i,"/v1/api/robotQA/sendQues"),s,d,(function(t){var n=t.data,o=t.msg,r=t.statusCode,i=n||{},a=i.answer,s=i.answerType;if(e.emit("message",n),0!==r)return console.error("提问失败:",o),void e.talk("抱歉，服务器开小差了。");if(a.indexOf("正在思考中,待会再问我吧")>-1)e.talk("正在思考中,待会再问我吧");else if("TEXT"!==s)"MENU"!==s?"RICH_TEXT"!==s?"LLM_TEXT"!==s?e.talk("抱歉，我无法理解你的问题。"):e.talk(a):e.talk("这是一个富文本"):e.talk("这是一个菜单");else{var c=u.parseFromString(a,"text/html").body.textContent;e.talk(c)}}))}},n.on("wakeup",(function(t,n){e.opt.wakeResponse&&e.talk(e.opt.wakeResponse),e.isWakeup=!0})),n.on("asrResult",(function(t){e.isWakeup&&(p(t),e.isWakeup=!1)}));case 15:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var N='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="icon" width="64px" height="64.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M480 544V853.333333h-64v-200.106666l-222.72 222.72-45.226667-45.226667 222.72-222.72H170.666667v-64h309.333333z m350.72-395.946667l45.226667 45.226667-222.72 222.72H853.333333v64h-309.333333V170.666667h64v200.106666l222.72-222.72z" /></svg>';function R(t,e){var n=t.isMobile,o=t.$dom,r=t.opt,i=r.courseId||r.courseGroupId||r.mirrorCourseId,a=t.$options.element;if(!i&&!a){r.useToonFigure&&(e={width:200,height:200,miniScale:40,offsetBottom:e.offsetBottom});var s=o.querySelector(".cx-robot-trigger")||o.querySelector(".figure-wrapper"),c=document.createElement("div");c.classList.add("resizer"),c.innerHTML=N;var u=e.miniScale||100,l=e.width/100*u,d=e.height/100*u;n&&(s.style.width="".concat(l,"px"),s.style.height="".concat(d,"px"));var p=function(){c.innerHTML='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="icon" width="64px" height="64.00px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M425.386667 553.386667l45.226666 45.226666-201.386666 201.386667h178.773333v64H160V576h64v178.688l201.386667-201.301333z m438.613333-393.386667v288h-64V269.226667l-201.386667 201.386666-45.226666-45.226666 201.301333-201.386667H576v-64h288z" /></svg>';var e=o.offsetHeight,n=getComputedStyle(o).bottom;o.dataset.bottom=n,o.style.bottom="".concat(parseInt(n)+e,"px"),s.classList.add("mini"),t.emit("figureVisibleChange",!1)};t.on("winVisibleChange",(function(t){t?c.style.setProperty("display","none"):(c.style.removeProperty("display"),s.style.removeProperty("display"))})),t.toggleSize=function(){s.classList.contains("mini")?function(){c.innerHTML=N;var n=o.dataset.bottom;o.style.bottom=n||"".concat(e.offsetBottom,"px"),s.classList.remove("mini"),t.emit("figureVisibleChange",!0)}():p()},t.once("initSuccess",(function(){r.hiddenFigure&&p()}));var f=function(){var e=Date.now();c.onpointerup=function(){Date.now()-e<300&&t.toggleSize(),c.onpointerup=null}};c.addEventListener("pointerdown",f),t.once("destroy",(function(){c.removeEventListener("pointerdown",f)})),o.appendChild(c)}}var z=function(){function t(e){f(this,t),this.options=e,this.defines={inset:[{enable:function(){return!0},value:"/embedChat"}],openUrl:[{enable:function(){return"digital"===e.openPage},value:"/chatDigitalHuman"},{enable:function(){return"coze"===e.openPage},value:"/coze"},{enable:function(){return!0},value:"/v1/front/toVisitorEnd"}],side:[{enable:function(){return"digital"===e.openPage},value:"/chatDigitalHuman/mobile"},{enable:function(){return"coze"===e.openPage},value:"/coze/mobile"},{enable:function(){return!0},value:"/embedChat/mobile"}]}}return g(t,[{key:"build",value:function(t){var e=this.paramsToString(t),n=this.options,o=n.type,r=n.origin,i=this.defines[o].find((function(t){return t.enable()}));return"".concat(r).concat(i.value).concat(e)}},{key:"paramsToString",value:function(t){for(var e="",n=Object.keys(t),o=0;o<n.length;o++){var r=n[o],i=t[r];null!=i&&""!==i&&(e+=0===o?"?"+r+"="+encodeURIComponent(i):"&"+r+"="+encodeURIComponent(i))}return e}}]),t}(),M=function(){function t(){f(this,t),this.listeners={}}return g(t,[{key:"on",value:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"once",value:function(t,e){var n=this;this.on(t,(function o(){e.apply(void 0,arguments),n.off(t,o)}))}},{key:"off",value:function(t,e){!t||e?t&&e&&(this.listeners[t]=this.listeners[t].filter((function(t){return t!==e}))):this.listeners[t]=[]}},{key:"emit",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.listeners[t]&&this.listeners[t].forEach((function(t){t.apply(void 0,n)}))}},{key:"clear",value:function(){this.listeners={}}}]),t}(),B="object"==("undefined"==typeof global?"undefined":n(global))&&global&&global.Object===Object&&global,D="object"==("undefined"==typeof self?"undefined":n(self))&&self&&self.Object===Object&&self,$=B||D||Function("return this")(),F=$.Symbol,q=Object.prototype,U=q.hasOwnProperty,H=q.toString,W=F?F.toStringTag:void 0;var V=Object.prototype.toString;var G="[object Null]",X="[object Undefined]",Y=F?F.toStringTag:void 0;function J(t){return null==t?void 0===t?X:G:Y&&Y in Object(t)?function(t){var e=U.call(t,W),n=t[W];try{t[W]=void 0;var o=!0}catch(t){}var r=H.call(t);return o&&(e?t[W]=n:delete t[W]),r}(t):function(t){return V.call(t)}(t)}function Q(t){return null!=t&&"object"==n(t)}var K="[object Symbol]";function Z(t){return"symbol"==n(t)||Q(t)&&J(t)==K}var tt=Array.isArray,et=1/0,nt=F?F.prototype:void 0,ot=nt?nt.toString:void 0;function rt(t){if("string"==typeof t)return t;if(tt(t))return function(t,e){for(var n=-1,o=null==t?0:t.length,r=Array(o);++n<o;)r[n]=e(t[n],n,t);return r}(t,rt)+"";if(Z(t))return ot?ot.call(t):"";var e=t+"";return"0"==e&&1/t==-et?"-0":e}function it(t){var e=n(t);return null!=t&&("object"==e||"function"==e)}function at(t){return t}var st="[object AsyncFunction]",ct="[object Function]",ut="[object GeneratorFunction]",lt="[object Proxy]";function dt(t){if(!it(t))return!1;var e=J(t);return e==ct||e==ut||e==st||e==lt}var pt,ft=$["__core-js_shared__"],ht=(pt=/[^.]+$/.exec(ft&&ft.keys&&ft.keys.IE_PROTO||""))?"Symbol(src)_1."+pt:"";var vt=Function.prototype.toString;var gt=/^\[object .+?Constructor\]$/,yt=Function.prototype,mt=Object.prototype,bt=yt.toString,wt=mt.hasOwnProperty,xt=RegExp("^"+bt.call(wt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function kt(t){return!(!it(t)||(e=t,ht&&ht in e))&&(dt(t)?xt:gt).test(function(t){if(null!=t){try{return vt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function _t(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return kt(n)?n:void 0}var St=Object.create,Tt=function(){function t(){}return function(e){if(!it(e))return{};if(St)return St(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var It=Date.now;var Ot,jt,Et,At=function(){try{var t=_t(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ct=At,Lt=Ct?function(t,e){return Ct(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:at,Pt=(Ot=Lt,jt=0,Et=0,function(){var t=It(),e=16-(t-Et);if(Et=t,e>0){if(++jt>=800)return arguments[0]}else jt=0;return Ot.apply(void 0,arguments)}),Nt=Pt,Rt=9007199254740991,zt=/^(?:0|[1-9]\d*)$/;function Mt(t,e){var o=n(t);return!!(e=null==e?Rt:e)&&("number"==o||"symbol"!=o&&zt.test(t))&&t>-1&&t%1==0&&t<e}function Bt(t,e,n){"__proto__"==e&&Ct?Ct(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Dt(t,e){return t===e||t!=t&&e!=e}var $t=Object.prototype.hasOwnProperty;function Ft(t,e,n){var o=t[e];$t.call(t,e)&&Dt(o,n)&&(void 0!==n||e in t)||Bt(t,e,n)}var qt=Math.max;function Ut(t,e){return Nt(function(t,e,n){return e=qt(void 0===e?t.length-1:e,0),function(){for(var o=arguments,r=-1,i=qt(o.length-e,0),a=Array(i);++r<i;)a[r]=o[e+r];r=-1;for(var s=Array(e+1);++r<e;)s[r]=o[r];return s[e]=n(a),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,s)}}(t,e,at),t+"")}var Ht=9007199254740991;function Wt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Ht}function Vt(t){return null!=t&&Wt(t.length)&&!dt(t)}var Gt=Object.prototype;function Xt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Gt)}function Yt(t){return Q(t)&&"[object Arguments]"==J(t)}var Jt=Object.prototype,Qt=Jt.hasOwnProperty,Kt=Jt.propertyIsEnumerable,Zt=Yt(function(){return arguments}())?Yt:function(t){return Q(t)&&Qt.call(t,"callee")&&!Kt.call(t,"callee")},te=Zt;var ee="object"==("undefined"==typeof exports?"undefined":n(exports))&&exports&&!exports.nodeType&&exports,ne=ee&&"object"==("undefined"==typeof module?"undefined":n(module))&&module&&!module.nodeType&&module,oe=ne&&ne.exports===ee?$.Buffer:void 0,re=(oe?oe.isBuffer:void 0)||function(){return!1},ie={};ie["[object Float32Array]"]=ie["[object Float64Array]"]=ie["[object Int8Array]"]=ie["[object Int16Array]"]=ie["[object Int32Array]"]=ie["[object Uint8Array]"]=ie["[object Uint8ClampedArray]"]=ie["[object Uint16Array]"]=ie["[object Uint32Array]"]=!0,ie["[object Arguments]"]=ie["[object Array]"]=ie["[object ArrayBuffer]"]=ie["[object Boolean]"]=ie["[object DataView]"]=ie["[object Date]"]=ie["[object Error]"]=ie["[object Function]"]=ie["[object Map]"]=ie["[object Number]"]=ie["[object Object]"]=ie["[object RegExp]"]=ie["[object Set]"]=ie["[object String]"]=ie["[object WeakMap]"]=!1;var ae="object"==("undefined"==typeof exports?"undefined":n(exports))&&exports&&!exports.nodeType&&exports,se=ae&&"object"==("undefined"==typeof module?"undefined":n(module))&&module&&!module.nodeType&&module,ce=se&&se.exports===ae&&B.process,ue=function(){try{var t=se&&se.require&&se.require("util").types;return t||ce&&ce.binding&&ce.binding("util")}catch(t){}}(),le=ue&&ue.isTypedArray,de=le?function(t){return function(e){return t(e)}}(le):function(t){return Q(t)&&Wt(t.length)&&!!ie[J(t)]},pe=de,fe=Object.prototype.hasOwnProperty;function he(t,e){var n=tt(t),o=!n&&te(t),r=!n&&!o&&re(t),i=!n&&!o&&!r&&pe(t),a=n||o||r||i,s=a?function(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}(t.length,String):[],c=s.length;for(var u in t)!e&&!fe.call(t,u)||a&&("length"==u||r&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Mt(u,c))||s.push(u);return s}var ve=Object.prototype.hasOwnProperty;function ge(t){if(!it(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=Xt(t),n=[];for(var o in t)("constructor"!=o||!e&&ve.call(t,o))&&n.push(o);return n}function ye(t){return Vt(t)?he(t,!0):ge(t)}var me=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,be=/^\w*$/;var we=_t(Object,"create");var xe=Object.prototype.hasOwnProperty;var ke=Object.prototype.hasOwnProperty;function _e(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}function Se(t,e){for(var n=t.length;n--;)if(Dt(t[n][0],e))return n;return-1}_e.prototype.clear=function(){this.__data__=we?we(null):{},this.size=0},_e.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},_e.prototype.get=function(t){var e=this.__data__;if(we){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return xe.call(e,t)?e[t]:void 0},_e.prototype.has=function(t){var e=this.__data__;return we?void 0!==e[t]:ke.call(e,t)},_e.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=we&&void 0===e?"__lodash_hash_undefined__":e,this};var Te=Array.prototype.splice;function Ie(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}Ie.prototype.clear=function(){this.__data__=[],this.size=0},Ie.prototype.delete=function(t){var e=this.__data__,n=Se(e,t);return!(n<0)&&(n==e.length-1?e.pop():Te.call(e,n,1),--this.size,!0)},Ie.prototype.get=function(t){var e=this.__data__,n=Se(e,t);return n<0?void 0:e[n][1]},Ie.prototype.has=function(t){return Se(this.__data__,t)>-1},Ie.prototype.set=function(t,e){var n=this.__data__,o=Se(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this};var Oe=_t($,"Map");function je(t,e){var o,r,i=t.__data__;return("string"==(r=n(o=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==o:null===o)?i["string"==typeof e?"string":"hash"]:i.map}function Ee(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}Ee.prototype.clear=function(){this.size=0,this.__data__={hash:new _e,map:new(Oe||Ie),string:new _e}},Ee.prototype.delete=function(t){var e=je(this,t).delete(t);return this.size-=e?1:0,e},Ee.prototype.get=function(t){return je(this,t).get(t)},Ee.prototype.has=function(t){return je(this,t).has(t)},Ee.prototype.set=function(t,e){var n=je(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this};var Ae="Expected a function";function Ce(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Ae);var n=function n(){var o=arguments,r=e?e.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var a=t.apply(this,o);return n.cache=i.set(r,a)||i,a};return n.cache=new(Ce.Cache||Ee),n}Ce.Cache=Ee;var Le=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pe=/\\(\\)?/g,Ne=function(t){var e=Ce(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Le,(function(t,n,o,r){e.push(o?r.replace(Pe,"$1"):n||t)})),e})),Re=Ne;function ze(t,e){return tt(t)?t:function(t,e){if(tt(t))return!1;var o=n(t);return!("number"!=o&&"symbol"!=o&&"boolean"!=o&&null!=t&&!Z(t))||be.test(t)||!me.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:Re(function(t){return null==t?"":rt(t)}(t))}var Me=1/0;function Be(t){if("string"==typeof t||Z(t))return t;var e=t+"";return"0"==e&&1/t==-Me?"-0":e}function De(t,e,n){var o=null==t?void 0:function(t,e){for(var n=0,o=(e=ze(e,t)).length;null!=t&&n<o;)t=t[Be(e[n++])];return n&&n==o?t:void 0}(t,e);return void 0===o?n:o}var $e=function(t,e){return function(n){return t(e(n))}}(Object.getPrototypeOf,Object),Fe=$e,qe="[object Object]",Ue=Function.prototype,He=Object.prototype,We=Ue.toString,Ve=He.hasOwnProperty,Ge=We.call(Object);function Xe(t){var e=this.__data__=new Ie(t);this.size=e.size}Xe.prototype.clear=function(){this.__data__=new Ie,this.size=0},Xe.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Xe.prototype.get=function(t){return this.__data__.get(t)},Xe.prototype.has=function(t){return this.__data__.has(t)},Xe.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Ie){var o=n.__data__;if(!Oe||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ee(o)}return n.set(t,e),this.size=n.size,this};var Ye="object"==("undefined"==typeof exports?"undefined":n(exports))&&exports&&!exports.nodeType&&exports,Je=Ye&&"object"==("undefined"==typeof module?"undefined":n(module))&&module&&!module.nodeType&&module,Qe=Je&&Je.exports===Ye?$.Buffer:void 0,Ke=Qe?Qe.allocUnsafe:void 0;var Ze=$.Uint8Array;function tn(t,e){var n,o,r=e?(n=t.buffer,o=new n.constructor(n.byteLength),new Ze(o).set(new Ze(n)),o):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var en,nn=function(t,e,n){for(var o=-1,r=Object(t),i=n(t),a=i.length;a--;){var s=i[en?a:++o];if(!1===e(r[s],s,r))break}return t},on=nn;function rn(t,e,n){(void 0!==n&&!Dt(t[e],n)||void 0===n&&!(e in t))&&Bt(t,e,n)}function an(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function sn(t){return function(t,e,n,o){var r=!n;n||(n={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=o?o(n[s],t[s],s,n,t):void 0;void 0===c&&(c=t[s]),r?Bt(n,s,c):Ft(n,s,c)}return n}(t,ye(t))}function cn(t,e,n,o,r,i,a){var s=an(t,n),c=an(e,n),u=a.get(c);if(u)rn(t,n,u);else{var l,d=i?i(s,c,n+"",t,e,a):void 0,p=void 0===d;if(p){var f=tt(c),h=!f&&re(c),v=!f&&!h&&pe(c);d=c,f||h||v?tt(s)?d=s:Q(l=s)&&Vt(l)?d=function(t,e){var n=-1,o=t.length;for(e||(e=Array(o));++n<o;)e[n]=t[n];return e}(s):h?(p=!1,d=function(t,e){if(e)return t.slice();var n=t.length,o=Ke?Ke(n):new t.constructor(n);return t.copy(o),o}(c,!0)):v?(p=!1,d=tn(c,!0)):d=[]:function(t){if(!Q(t)||J(t)!=qe)return!1;var e=Fe(t);if(null===e)return!0;var n=Ve.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&We.call(n)==Ge}(c)||te(c)?(d=s,te(s)?d=sn(s):it(s)&&!dt(s)||(d=function(t){return"function"!=typeof t.constructor||Xt(t)?{}:Tt(Fe(t))}(c))):p=!1}p&&(a.set(c,d),r(d,c,o,i,a),a.delete(c)),rn(t,n,d)}}function un(t,e,n,o,r){t!==e&&on(e,(function(i,a){if(r||(r=new Xe),it(i))cn(t,e,a,n,un,o,r);else{var s=o?o(an(t,a),i,a+"",t,e,r):void 0;void 0===s&&(s=i),rn(t,a,s)}}),ye)}var ln,dn=(ln=function(t,e,n){un(t,e,n)},Ut((function(t,e){var o=-1,r=e.length,i=r>1?e[r-1]:void 0,a=r>2?e[2]:void 0;for(i=ln.length>3&&"function"==typeof i?(r--,i):void 0,a&&function(t,e,o){if(!it(o))return!1;var r=n(e);return!!("number"==r?Vt(o)&&Mt(e,o.length):"string"==r&&e in o)&&Dt(o[e],t)}(e[0],e[1],a)&&(i=r<3?void 0:i,r=1),t=Object(t);++o<r;){var s=e[o];s&&ln(t,s,o,i)}return t}))),pn=dn,fn=function(){function t(e){f(this,t),this.locale=e||"zh-CN",this.packages=new Map}return g(t,[{key:"setLocale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh-CN";if(!this.packages.has(t))throw new Error("Locale ".concat(t," not found"));this.locale=t}},{key:"register",value:function(t,e){this.packages.set(t,e)}},{key:"t",value:function(t){var e=this.packages.get(this.locale);return e?De(e,t,t):t}}]),t}();var hn={course:{slogan:"学习是一种信仰",trial:"点击我，就可以体验~"}};var vn={course:{slogan:"Learning is a faith",trial:"Click me to experience it～"}};function gn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function yn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?gn(Object(n),!0).forEach((function(e){y(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):gn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var mn=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,t);var o=navigator.userAgent;this.hooks=new M,this.$options=n,this.progress=0,this.id="".concat(n.robotId,"_").concat(Date.now()),this.scene=n.scene||"normal",this.useToonFigure=1==+n.useToonFigure,this.ajax=new m({headers:function(){return{}}}),this.isMobile=/(iPhone|iPod|Android|ios|SymbianOS)/i.test(o),this.containerH=this.isMobile?500:600,this.containerW=this.isMobile?window.screen.width:700,this.figureH=80,this.figureW=80,this.miniScale=40,this.miniImgUrl="//robot.chaoxing.com/sdk/sdkLogo.png",this.translate={x:0,y:0},this.isWakeup=!1,this.disableDrag=!1;var r,i,a,s=new fn;s.register("zh-CN",hn),s.register("en-US",vn),this.$i18n=s,this.isChaoxingMooc=(r=window.location.hostname,i=r.indexOf("chaoxing.com"),a=r.indexOf("mooc")>-1,i&&a),E.forEach((function(t){t.install.call(e,n)})),this.init(n)}var n;return g(t,[{key:"on",value:function(t,e){this.hooks.on(t,e)}},{key:"once",value:function(t,e){var n=this;this.hooks.on(t,(function o(){e.apply(void 0,arguments),n.off(t,o)}))}},{key:"off",value:function(t,e){this.hooks.off(t,e)}},{key:"emit",value:function(t){for(var e,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];(e=this.hooks).emit.apply(e,[t].concat(o))}},{key:"setOpt",value:function(t){var e=t.toonPreset||"normal",n={accessToken:t.accessToken||"",visitorId:t.visitorId||"",unitId:t.unitId||"",robotId:t.robotId||"",groupId:t.groupId||"",uid:b("UID")||t.visitorId||"",vc:b("vc")||"",_d:b("_d")||"",d:b("_d")||"",vc3:b("vc3")||"",scene:t.scene||"",toonPreset:e,courseId:t.courseId||""},o=k(t.allowOpenChatWin)?1:+t.allowOpenChatWin,r=k(t.useBuiltInNotify)?1:+t.useBuiltInNotify,i={origin:t.origin||"//robot.chaoxing.com",rootClass:t.rootClass||"",type:t.openType||"inset",autoOpen:1==+t.autoOpen,useToonFigure:1==+t.useToonFigure,toonRenderer:t.toonRenderer,toonPreset:e,showTalkContent:1==+t.showTalkContent,allowOpenChatWin:1===o,asr:1==+t.asr,wakeword:t.wakeword||"",wakewordAuxs:t.wakewordAuxs||"",wakeResponse:t.wakeResponse||"",useBuiltInNotify:1===r,openPage:t.openPage||"",locale:t.locale||"zh-CN",discoverHost:t.discoverHost||"",tone:t.tone||"",hiddenFigure:1==+t.hiddenFigure};this.$i18n.setLocale(i.locale),this.opt=Object.assign({},n,i);var a=Object.keys(this.opt);a.push("miniToonPreset");var s=Object.keys(t).filter((function(t){return-1===a.indexOf(t)})).reduce((function(e,n){return e[n]=t[n],e}),{}),c=yn(yn(yn({},n),s),{},{tone:this.opt.tone,_cxsdk:1}),u=new z(i);this.opt.url=u.build(c)}},{key:"fillDom",value:function(t){var e=this,n=20,o=100;t&&(n=t.offsetRight,o=t.offsetBottom,this.figureH=t.height,this.figureW=t.width,this.miniImgUrl=t.buttonImg),this.isMobile&&(n=0);var r={right:isNaN(n)?n:"".concat(n,"px"),bottom:isNaN(o)?o:"".concat(o,"px")},i='\n      <div class="cx-robot-wrapper '.concat(this.opt.rootClass,'" data-scene=').concat(this.scene," data-preset=").concat(this.opt.toonPreset,' id="').concat(this.id,'" style="right:').concat(r.right,";bottom:").concat(r.bottom,'">\n        <div class="loading-wrapper"></div>\n        <div class="interaction-wrapper" style="width:').concat(this.containerW,"px;height:").concat(this.containerH,'px">\n          <div class="interaction-header">\n            <div class="minimize">\n              <div class="inner"></div>\n            </div>\n          </div>\n          <div class="interaction-content"></div>\n        </div>\n      </div>\n    '),a=new DOMParser,s=a.parseFromString(i,"text/html").body.children[0];this.isChaoxingMooc&&this.useToonFigure&&"course"===this.scene&&s.classList.add("cx-mooc"),this.$dom=s,document.body.appendChild(s);var c=this.useToonFigure?'<div class="figure-wrapper toon" data-mobile='.concat(e.isMobile," data-scene=").concat(e.scene," data-preset=").concat(e.opt.toonPreset,"></div>"):'\n      <div class="cx-robot-trigger" data-scene='.concat(e.scene," data-preset=").concat(e.opt.toonPreset,' style="width:').concat(e.figureW,"px;height:").concat(e.figureH,'px;">\n        <div class="figure-wrapper">\n          <img alt="" src="').concat(e.miniImgUrl,'" referrerPolicy="no-referrer"  style="width:100%;height:100%;"/>\n        </div>\n        <div class="loading-wrapper">\n          <img class="normal" alt="" src="http://p.ananas.chaoxing.com/star3/origin/c77c801b1670e2d960c493ee15bc0e2b" referrerPolicy="no-referrer" />\n        </div>\n      </div>\n      '),u=a.parseFromString(c,"text/html").body.children[0];this.element?(u.classList.add("anchor-figure"),this.element.appendChild(u)):this.$dom.querySelector(".interaction-wrapper").before(u),this.$figure=u}},{key:"createFigure",value:(n=e(d.mark((function t(){var e,n,o=this;return d.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.useToonFigure){t.next=9;break}return e={origin:this.opt.origin,element:this.$figure,preset:this.opt.toonPreset,asr:this.opt.asr?1:0,wakeword:this.opt.wakeword,wakewordAuxs:this.opt.wakewordAuxs,speak:0,tone:this.opt.tone,renderer:this.opt.toonRenderer},t.next=4,VoiceToonBot.init(e);case 4:return n=t.sent,this.opt.asr&&(L(this,n),n.on("wakeup",(function(){o.emit("wakeup")})),n.on("asrResult",(function(t){o.emit("asrResult",t)})),n.on("asrError",(function(t){o.emit("asrError",t)}))),n.once("loadComplete",(function(){o.emit("domloaded",o.$dom,o.$options)})),this.$toonRobot=n,t.abrupt("return");case 9:this.emit("domloaded",this.$dom,this.$options);case 10:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"bind",value:function(){var e=this,n=this.$dom,o=this.$dom.querySelector(".interaction-header").querySelector(".minimize"),r=this.$figure;this.on("progress",(function(n){n<100||(e.opt.type===t.OPEN_TYPE.INSET?e._handleInsetLoaded():e.opt.type===t.OPEN_TYPE.SIDE&&e._handleSideLoaded())})),this.on("winVisibleChange",(function(t){e.winVisible=t})),this.opt.autoOpen&&this.once("initSuccess",(function(){return e._openWin()})),this.drag(n),void 0!==this.$toonRobot&&(this.$toonRobot.on("talkStart",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];e.emit.apply(e,["talkStart"].concat(n))})),this.$toonRobot.on("talkEnd",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];e.emit.apply(e,["talkEnd"].concat(n))}))),r.addEventListener("pointerdown",(function(n){var o=n.target,i=e.$figure.querySelector(".cx-vbot-control");if((!i||o!==i&&!i.contains(o))&&0==n.button){var a=Date.now();r.onpointerup=function(n){if(Date.now()-a<300){if(!1===e.opt.allowOpenChatWin)return;if(e.opt.type===t.OPEN_TYPE.NEW_TAB)return void e._openURL(e.opt.url);e._openWin(),e.emit("winVisibleChange",!0),e.fixPosition()}}}})),o.addEventListener("click",this._close.bind(this)),this._messageHandler=this.handleMessage.bind(this),window.addEventListener("message",this._messageHandler)}},{key:"setTranslate",value:function(t,e){this.translate.x=t,this.translate.y=e,this.$dom.style.transform="translate(".concat(t,"px, ").concat(e,"px)")}},{key:"drag",value:function(t){var e=this;!function(t,e){var n=0,o=0;function r(t){(t=t||window.event).preventDefault();var r=t.clientX,i=t.clientY,a=r-n,s=i-o;n=r,o=i,e({dx:a,dy:s,phase:"drag"})}function i(){document.onpointerup=null,document.onpointermove=null,e({dx:0,dy:0,phase:"dragEnd"})}t.onpointerdown=function(t){(t=t||window.event).preventDefault(),n=t.clientX,o=t.clientY,document.onpointerup=i,document.onpointermove=r,e({dx:0,dy:0,phase:"dragStart"})}}(t,(function(n){var o=n.dx,r=n.dy,i=n.phase;if(!e.disableDrag){var a=t.getBoundingClientRect(),s=a.top,c=a.left,u=a.width,l=a.height,d=c+o,p=s+r;if(!(d<0||p<0)){var f=p+l;if(!(d+u>window.innerWidth||f>window.innerHeight)){var h=e.translate.x+o,v=e.translate.y+r;if(e.setTranslate(h,v),e.emit(i,{x:c,y:s,width:u,height:l,target:t,dx:o,dy:r}),"dragStart"===i)document.querySelectorAll("iframe").forEach((function(t){return t.style.pointerEvents="none"}));if("dragEnd"===i)document.querySelectorAll("iframe").forEach((function(t){return t.style.pointerEvents="auto"}))}}}}))}},{key:"_openWin",value:function(){this.opt.type!==t.OPEN_TYPE.SIDE?this.openWithInset():this.openWithSide()}},{key:"openWithSide",value:function(){var t=this;if(this.$sideDom)return this.$sideDom.classList.remove("hide"),void requestAnimationFrame((function(){t.$sideDom.querySelector(".interaction-container").classList.add("expand"),void 0===t.opt.element&&t.hide()}));var e=(new DOMParser).parseFromString('<div class="cx-robot-side">\n      <div class="interaction-container">\n        <div class="side-close"></div>\n        <div class="side-content"></div>\n      </div>\n    </div>',"text/html").body.firstChild,n=e.querySelector(".interaction-container"),o=e.querySelector(".side-content");e.querySelector(".side-close").addEventListener("click",this._close.bind(this));var r=this._createIframe();o.appendChild(r),n.appendChild(o),void 0===this.opt.element&&this.hide(),document.body.appendChild(e),document.body.classList.add("cx-robot-side-open"),requestAnimationFrame((function(){n.classList.add("expand")})),e.addEventListener("click",(function(n){e===n.target&&t._close()})),this.$sideDom=e}},{key:"openWithInset",value:function(){var t=this,e=this.$figure,n=this.$dom.querySelector(".interaction-content"),o=e.querySelector(".loading-wrapper"),r=this.$dom.querySelector(".interaction-wrapper");if(this.$dom.classList.add("expand"),0==n.childNodes.length){var i=setInterval((function(){if(98-t.progress<=0)return clearInterval(i),void t.emit("progress",t.progress);var e=Math.floor(3*Math.random());t.progress+=e,t.emit("progress",t.progress)}),1e3/30);e.style.opacity="0.3",o&&(o.style.display="block"),this.$figure.classList.add("loading"),this.$dom.classList.add("loading");var a=this._createIframe();n.appendChild(a)}else e.style.display="none",r.style.display="block"}},{key:"_createIframe",value:function(){var t=this,e=document.createElement("iframe");return e.id="CxRobotIframe_".concat(Date.now()),e.style.border="none",e.style.width="100%",e.style.height="100%",e.setAttribute("allow","camera; microphone; clipboard-write; clipboard-read; autoplay; fullscreen;"),e.setAttribute("scrolling","no"),e.setAttribute("frameborder","0"),e.setAttribute("marginheight","0"),e.setAttribute("marginwidth","0"),e.onload=function(){e.contentWindow.postMessage({type:"CX_ROBOT_SDK_INIT",origin:location.origin,referer:location.href,options:t.opt},"*"),t.progress=100,t.emit("progress",t.progress)},e.src=this.opt.url,e}},{key:"_close",value:function(){this.opt.type!==t.OPEN_TYPE.NEW_TAB&&(this.opt.type===t.OPEN_TYPE.SIDE?this._closeWithSide():this._closeWithInset())}},{key:"_closeWithSide",value:function(){var t=this;document.body.classList.remove("cx-robot-side-open");var e=this.$sideDom.querySelector(".interaction-container");e.classList.remove("expand"),e.addEventListener("transitionend",(function(){t.$sideDom.classList.add("hide")}),{once:!0}),this.emit("winVisibleChange",!1),this.show()}},{key:"_closeWithInset",value:function(){var t=this.$figure,e=this.$dom.querySelector(".interaction-wrapper");t.style.display="block",e.style.display="none",this.$dom.classList.remove("expand"),this.emit("winVisibleChange",!1)}},{key:"_handleSideLoaded",value:function(){}},{key:"_handleInsetLoaded",value:function(){var t=this;setTimeout((function(){var e=t.$dom.querySelector(".interaction-wrapper"),n=t.$figure,o=t.$figure.querySelector(".loading-wrapper");n.style.display="none",n.style.opacity="1",e.style.display="block",o&&(o.style.display="none"),t.$dom.classList.remove("loading"),t.$figure.classList.remove("loading"),t.fixPosition(),t.emit("winVisibleChange",!0)}),300)}},{key:"fixPosition",value:function(){var t=this.$dom.getBoundingClientRect(),e=t.left,n=t.top,o=this.translate.x,r=this.translate.y;e<0&&(o-=e),n<0&&(r-=n),this.setTranslate(o,r)}},{key:"init",value:function(t){var e=this;if(t&&t.accessToken&&t.unitId&&t.robotId){t.element&&(this.element="string"==typeof t.element?document.querySelector(t.element):t.element),this.emit("beforeInit",t),this.setOpt(t);var n=this.opt,o=n.origin,r=n.unitId,i=n.robotId,a=n.accessToken,s="".concat(o,"/v1/api/doorChat/check?unitId=").concat(r,"&robotId=").concat(i,"&enc=").concat(a);return this.ajax.get(s,null,(function(t){0===t.statusCode&&(e.fillDom(t.data),R(e,t.data),e.createFigure().then((function(){e.bind(),e.emit("initSuccess",e.$dom,e.$options)})))})),this}}},{key:"talk",value:function(t){var e=this;t&&"string"==typeof t&&void 0!==this.$toonRobot&&(this.$toonRobot.talk(t),this.opt.showTalkContent&&(this.notify(t),this.$toonRobot.once("talkEnd",(function(){e.stopNotify()}))))}},{key:"intercept",value:function(){this.$toonRobot&&"function"==typeof this.$toonRobot.intercept&&(this.stopNotify(),this.$toonRobot.intercept())}},{key:"notify",value:function(t){this.stopNotify();var e=this.$dom.childNodes[0],n=document.createElement("div");n.className="notify notify-wrapper",n.innerHTML=t,this.$dom.insertBefore(n,e)}},{key:"stopNotify",value:function(){var t=this.$dom.querySelector(".notify");t&&(t.style.display="none",t.parentNode.removeChild(t))}},{key:"destroy",value:function(){"function"==typeof this.stopNotify&&this.stopNotify(),this.$dom.parentNode.removeChild(this.$dom),this.$toonRobot&&this.$toonRobot.destroy(),window.removeEventListener("message",this._messageHandler),this.emit("destroy"),this.hooks.clear()}},{key:"handleMessage",value:function(t){var e=t.data,n=e.type,o=e.data;if(n&&n.startsWith("CXBOT_PAGE:")){var i=r(n.split(":"),2)[1];if("localeChange"===i)return this.setLocale(o),void this.$toonRobot.setLocale(o);"minimize"!==i?this.emit(i,o):this._close()}}},{key:"hide",value:function(){this.$dom.style.display="none"}},{key:"show",value:function(){this.$dom.style.display="block"}},{key:"setLocale",value:function(t){this.$i18n.setLocale(t),this.emit("localeChange",t)}},{key:"_openURL",value:function(t){-1!==navigator.userAgent.toLowerCase().indexOf("chaoxingstudy")&&void 0!==window.jsBridge&&"function"==typeof window.jsBridge.postNotification?window.jsBridge.postNotification("CLIENT_OPEN_URL",{title:"",loadType:1,toolbarType:2,webUrl:t}):window.open(t,"_blank")}}]),t}();y(mn,"OPEN_TYPE",{INSET:"inset",SIDE:"side",NEW_TAB:"openUrl"});var bn=function(){function t(e){var n=this;f(this,t),this.options=e,this.hooks=new M,this.progress=0;var o=setInterval((function(){if(98-n.progress<=0)return clearInterval(o),void n.emit("progress",n.progress);var t=Math.floor(3*Math.random());n.progress+=t,n.emit("progress",n.progress)}),1e3/30);this.initOptions(),this.initDom(),this.initEvent()}return g(t,[{key:"initOptions",value:function(){var t=this.options,e=void 0===t?{}:t,n=e.origin,o=e.el;if(!o)throw new Error("el is required");if(!n)throw new Error("origin is required");"string"==typeof o&&(this.el=document.querySelector(o)),o instanceof HTMLElement&&(this.el=o);var r={accessToken:e.accessToken||"",visitorId:e.visitorId||"",unitId:e.unitId||"",robotId:e.robotId||"",groupId:e.groupId||"",uid:b("UID")||e.visitorId||"",vc:b("vc")||"",_d:b("_d")||"",d:b("_d")||"",vc3:b("vc3")||""};this.url="".concat(n,"/bare");for(var i=Object.keys(r),a=0;a<i.length;a++){var s=i[a],c=r[s];null!=c&&""!==c&&(this.url+=0===a?"?"+s+"="+c:"&"+s+"="+c)}}},{key:"initDom",value:function(){var t=this,e=(new DOMParser).parseFromString('<div class="bare-sdk"></div>',"text/html"),n=document.createElement("iframe");n.style.border="none",n.style.width="100%",n.style.height="100%",n.setAttribute("allow","camera; microphone"),n.setAttribute("scrolling","no"),n.setAttribute("frameborder","0"),n.setAttribute("marginheight","0"),n.setAttribute("marginwidth","0"),n.onload=function(){var e={type:"CX_ROBOT_SDK_INIT",origin:location.origin};n.contentWindow.postMessage(e,"*"),t.progress=100,t.emit("progress",t.progress),t.emit("initSuccess",t.$dom)},n.src=this.url,this.iframe=n;var o=e.body.children[0];o.appendChild(n),this.$dom=o,this.el.appendChild(o)}},{key:"initEvent",value:function(){this.messgeReciver=this.handleReceiveMessage.bind(this),window.addEventListener("message",this.messgeReciver)}},{key:"destroy",value:function(){window.removeEventListener("message",this.messgeReciver),this.iframe.parentElement.removeChild(this.iframe),this.iframe=null,this.emit("destroy"),this.hooks.clear()}},{key:"on",value:function(t,e){this.hooks.on(t,e)}},{key:"once",value:function(t,e){var n=this;this.hooks.on(t,(function o(){e.apply(void 0,arguments),n.off(t,o)}))}},{key:"off",value:function(t,e){this.hooks.off(t,e)}},{key:"emit",value:function(t){for(var e,n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];(e=this.hooks).emit.apply(e,[t].concat(o))}},{key:"postMessage",value:function(t,e){if(!this.iframe.contentWindow)throw new Error("iframe未加载完成");var n={type:"CXBOT:".concat(t),data:e};this.iframe.contentWindow.postMessage(n,this.url)}},{key:"handleReceiveMessage",value:function(t){var e=t.data,n=e.type,o=e.data;if(n&&n.startsWith("CXBOT_PAGE:")){var i=r(n.split(":"),2)[1];"message"!==i?this.emit(i,o):this.emit("message",o)}}},{key:"send",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).hidden,n=void 0!==e&&e;this.postMessage("send",{text:t,hidden:n})}},{key:"clearScreen",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.postMessage("clearScreen",t)}},{key:"connect",value:function(){this.postMessage("connect")}},{key:"speech",value:function(t){this.postMessage("speech",t)}},{key:"stopSpeech",value:function(){this.postMessage("stopSpeech")}}]),t}();function wn(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,n=Date.now(),o=null;return new Promise((function(r){window.addEventListener("message",(function(t){"CX_PAGE_LOAD_DETECT"===t.data.type&&(r({status:"success",message:"ok",win:t.source}),o&&cancelAnimationFrame(o))}));o=requestAnimationFrame((function i(){var a=Date.now();t.contentWindow&&t.contentWindow.postMessage&&t.contentWindow.postMessage({type:"CX_PAGE_LOAD_DETECT"},"*"),a-n>e&&(o&&cancelAnimationFrame(o),r({status:"timeout",message:"iframe is not loaded, may be network error or timeout"})),o=requestAnimationFrame(i)}))}))}var xn=function(){function t(e,n){f(this,t),this.target=n,this.options=e,this.hooks=new M;var o=this.handleReceiveMessage.bind(this);this.messageHandler=o,window.addEventListener("message",o)}return g(t,[{key:"handleReceiveMessage",value:function(t){var e=t.data,n=e.type,o=e.data;if(n&&n.startsWith("CXBOT_PAGE:")){var i=r(n.split(":"),2)[1];"message"!==i?this.emit(i,o):this.emit("message",o)}}},{key:"on",value:function(){var t;(t=this.hooks).on.apply(t,arguments)}},{key:"once",value:function(){var t;(t=this.hooks).once.apply(t,arguments)}},{key:"off",value:function(){var t;(t=this.hooks).off.apply(t,arguments)}},{key:"emit",value:function(){var t;(t=this.hooks).emit.apply(t,arguments)}},{key:"postMessage",value:function(t,e){console.log("[CXBOT_PAGE] postMessage: ".concat(t),e),this.target.postMessage({type:t,data:e},"*")}},{key:"destroy",value:function(){window.removeEventListener("message",this.messageHandler)}}]),t}();function kn(t,e,n){var o=function(t){t=decodeURIComponent(t);var e={};return t.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,n,o){e[n]=o})),e}(t),r=t.substring(0,t.indexOf("?")).replace("/embedChat","");return Object.assign({},o,{origin:r,accessToken:e,visitorId:n})}function _n(t){return new Promise((function(e,n){var o=new m({headers:function(){return{}}}),r=t.courseId,i=void 0===r?"":r,a=function(){var e=t.courseId,n=void 0===e?"":e,o=t.courseGroupId,r=void 0===o?"":o,i=t.mirrorCourseId,a=void 0===i?"":i,s=t.origin,c=void 0===s?location.origin:s,u=t.unitId||t.belongschoolid||"";if(n){var l="".concat(c,"/v1/api/robot/course/getRobotId?courseId=").concat(n);return u&&(l+="&unitId=".concat(u)),l}if(r){var d="".concat(c,"/v1/api/robot/courseGroup/getRobotId?courseGroupId=").concat(r);return u&&(d+="&unitId=".concat(u)),d}if(a){var p="".concat(c,"/v1/api/robot/mirrorCourse/getRobotId?mirrorCourseId=").concat(a);return u&&(p+="&unitId=".concat(u)),p}}();o.get(a,null,(function(o){var r=o.data,a=o.msg;if(0===o.statusCode){var s=r.robotId,c=r.unitId,u=r.accessToken,l=r.cartoonSetting,d=l?JSON.parse(l):{},f={miniToonPreset:d.miniToonPreset,toonPreset:d.toonPreset,tone:d.tone};Object.keys(f).forEach((function(t){""===f[t]&&(f[t]=void 0)}));var h=pn({},t,f,{robotId:s,unitId:c,accessToken:u,courseId:i,scene:"course"}),v=w(p),g=new mn(h);g.on("destroy",(function(){return v()})),e(g)}else n(new Error(a))}))}))}function Sn(t){return new Promise((function(e,n){var o;t.useToonFigure?(o="".concat(t.origin,"/sdk/VoiceToonBot.js"),new Promise((function(t,e){var n=document.createElement("script");n.onload=t,n.onerror=e,n.src=o,document.head.appendChild(n)}))).then(e,n):e(t)}))}window.addEventListener("message",(function(t){var e=t.data,n=e.type,o=e.action,r=e.params;"CX_JS_BRIDGE_PROXY"===n&&(window.top===window.self?window.jsBridge&&"function"==typeof window.jsBridge.postNotification&&window.jsBridge.postNotification(o,r):window.top.postMessage(t.data,"*"))})),window.addEventListener("message",(function(t){var e=t.data,n=e.type,o=e.data;if(n&&n.startsWith("CXBOT_DIRECT:")){var i=r(n.split(":"),2)[1];i&&"navigateTo"===i&&o.url&&(window.location.href=o.url)}}));var Tn={version:"2.10.6",init:function(t){var e=arguments;return new Promise((function(o,r){"object"!==n(t)&&(t=kn.apply(null,e)),Sn(t).then((function(){var e=t,n=e.courseId,i=e.courseGroupId,a=e.mirrorCourseId;if(n||i||a)_n(t).then(o).catch(r);else{var s=w(p),c=new mn(t);c.on("destroy",(function(){return s()})),c.on("winVisibleChange",(function(t){if(t){var e=c.translate,n=e.x,o=e.y;c.$dom.dataset.translateX=n,c.$dom.dataset.translateY=o}else if(c.$dom.dataset.translateX){var r=c.$dom.dataset,i=r.translateX,a=r.translateY;c.setTranslate(+i,+a)}})),o(c)}}),r)}))},openUrl:function(t){return(t=kn.apply(null,arguments)).openType="openUrl",this.init(t)},initBare:function(t){return new Promise((function(e){var n=w(p),o=new bn(t);o.on("destroy",(function(){return n()})),e(o)}))},createChannel:function(t){return e(d.mark((function e(){var n,o,r,i,a,s,c,u,l,p;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.robotWin,o=t.el,r=n){e.next=13;break}return i="string"==typeof selector?document.getElementById(o):o,e.next=6,wn(i);case 6:if(a=e.sent,s=a.status,c=a.message,u=a.win,"success"===s){e.next=12;break}throw new Error(c);case 12:r=u;case 13:return l={type:"CX_ROBOT_SDK_INIT",origin:location.origin,referer:location.href,options:{mode:"CHANNEL"}},r.postMessage(l,"*"),p=new xn(t,r),e.abrupt("return",p);case 17:case"end":return e.stop()}}),e)})))()}};return Tn}();
